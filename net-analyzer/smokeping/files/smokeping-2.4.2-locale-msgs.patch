diff -Nru smokeping-2.4.2.old/lib/Smokeping.pm smokeping-2.4.2/lib/Smokeping.pm
--- smokeping-2.4.2.old/lib/Smokeping.pm	2008-07-24 12:37:05.000000000 -0500
+++ smokeping-2.4.2/lib/Smokeping.pm	2010-08-27 12:42:50.000000000 -0500
@@ -8,7 +8,9 @@
 use Digest::MD5 qw(md5_base64);
 use SNMP_util;
 use SNMP_Session;
-use POSIX;
+# enable locale??
+#use locale;
+use POSIX qw(locale_h signal_h sys_wait_h);
 use Smokeping::Config;
 use RRDs;
 use Sys::Syslog qw(:DEFAULT setlogsock);
@@ -26,9 +28,36 @@
 # make sure we do not end up with , in odd places where one would expect a '.'
 # we set the environment variable so that our 'kids' get the benefit too
 
-$ENV{LC_NUMERIC}='C';
-if (POSIX::setlocale(&POSIX::LC_NUMERIC,"") ne "C") {
-    die("Resetting LC_NUMERIC failed - try removing LC_ALL from the environment");
+$ENV{'LC_NUMERIC'}='C';
+if (setlocale(LC_NUMERIC,"") ne "C") {
+    if ($ENV{'LC_ALL'} eq 'C') {
+        # This has got to be a bug in perl/mod_perl, apache or libc
+        die("Your internalization implementation on your operating system is "
+          . "not responding to your setup of LC_ALL to \"C\" as LC_NUMERIC is "
+          . "coming up as \"" . setlocale(LC_NUMERIC, "") . "\" leaving "
+          . "smokeping unable to compare numbers...");
+    }
+    elsif ($ENV{'LC_ALL'} ne "") {
+        # This error is most likely setup related and easy to fix with proper 
+        # setup of the operating system or multilanguage locale setup.  Hint,
+        # setting LANG is better than setting LC_ALL...
+        die("Resetting LC_NUMERIC failed probably because your international "
+          . "setup of the LC_ALL to \"". $ENV{'LC_ALL'} . "\" is overridding "
+          . "LC_NUMERIC.  Setting LC_ALL is not compatible with smokeping...");
+    }
+    else {
+        # This is pretty nasty to figure out.  Seems there are still lots
+        # of bugs in LOCALE behavior and if you get this error, you are
+        # affected by it.  The worst is when "setlocale" is reading the
+        # environment variables of your webserver and not reading the PERL
+        # %ENV array like it should.
+        die("Something is wrong with the internalization setup of your "
+          . "operating system, webserver, or the perl plugin to your webserver "
+          . "(like mod_perl) and smokeping can not compare numbers correctly.  "
+          . "On unix, check your /etc/locale.gen and run sudo locale-gen, set "
+          . "LC_NUMERIC in your perl plugin config or even your webserver "
+          . "startup script to potentially fix or work around the problem...");
+    }
 }
 
 
